# AI Frontend Development: Receipt Upload

## Task Overview
Create a user-friendly receipt upload interface that enables bookkeepers to easily upload receipt files (images or PDFs) to the system. The upload functionality should support single and batch uploads, provide clear feedback, and initiate the receipt processing workflow automatically.

## Business Context
Bookkeepers manage hundreds of receipts monthly for short-term rental businesses. The receipt upload process is the entry point to the entire system workflow. Efficiency in uploading and processing these documents is critical for timely financial record-keeping. 

Bookkeepers need to:
* Upload multiple receipts in a single operation to save time
* Easily track upload progress and status
* Be confident that receipts have been successfully added to the system
* Understand what happens next in the workflow

## Design Specifications

### Visual Design
* Create a modern, drag-and-drop upload area with clear visual cues
* Include a fallback button for traditional file selection
* Design a clean, organized list of uploaded files showing:
  * Filename
  * Upload status
  * Thumbnail (if applicable)
  * File size
* Use the application's color scheme for status indicators:
  * Blue for uploading/processing
  * Green for success
  * Red for errors/failures
* Implement a progress indicator for uploads
* Design appropriate error and success states

### User Experience
* Support both drag-and-drop and traditional file selection
* Provide clear visual feedback during the upload process
* Allow cancellation of in-progress uploads
* Enable retry for failed uploads
* Implement batch selection for uploading multiple files
* Show a summary of upload results
* Keep the interface responsive during uploads

### Functionality
* Accept image files (JPEG, PNG) and PDF documents
* Support single and multiple file uploads
* Validate files for type and size before upload
* Show upload progress in real-time
* Provide file preview functionality for uploaded files
* Allow removal of files from the upload queue
* Implement retry mechanism for failed uploads
* Create automatic receipt records in the database upon successful upload

## Content Requirements
* Page title: "Upload Receipts"
* Upload area text: "Drag and drop receipt files here, or click to browse"
* Button text: "Select Files"
* Supported file types message: "Supported formats: PDF, JPEG, PNG (Max 10MB)"
* Success message: "Receipt uploaded successfully! Processing will begin automatically."
* Error messages should be specific to the error type
* Progress indicators should show percentage complete
* Summary text: "Uploaded [X] of [Y] files successfully"

## Accessibility Requirements
* All interactive elements must be keyboard accessible
* Upload button must be properly labeled for screen readers
* Error messages must be announced to screen readers
* Focus management must be logical and predictable
* Progress updates must be communicated to screen readers
* Color alone should not convey status information

## Component Structure
* ReceiptUploadPage as the main container
* FileUploadZone component for drag-and-drop functionality
* FileUploadButton for traditional file selection
* UploadProgressList component to display file queue
* UploadProgressItem component for individual files
* FilePreview component for uploaded files
* UploadSummary component to display results

## Data Model
* Upload File item:
  * id: string (generated client-side)
  * file: File object
  * name: string
  * size: number
  * type: string
  * progress: number
  * status: 'queued' | 'uploading' | 'success' | 'error'
  * error: string (if applicable)
  * preview_url: string (for images)
* Receipt item (created in Supabase):
  * id: string (generated by Supabase)
  * file_path: string
  * file_name: string
  * upload_date: timestamp
  * status: 'new'
  * user_id: string (from authenticated user)

## Supabase Integration
* Connect directly to Supabase for storage and database operations:
  * Use Supabase Storage for file uploads: `supabase.storage.from('receipts').upload()`
  * Insert new records into the 'receipts' table: `supabase.from('receipts').insert()`
  * Track upload progress using the Supabase JS client's upload event handlers
* Implement proper error handling and retries for Supabase operations
* Structure storage paths using logical organization: `receipts/{user_id}/{timestamp}_{filename}`
* Handle authentication using Supabase Auth to identify the uploading user
* Follow the project's hybrid approach: use direct Supabase access for file uploads and initial record creation

## Behavioral Specifications
* File uploads should start immediately after files are selected or dropped
* Display upload progress in real-time
* Show thumbnail previews for image files after selection
* Generate PDF thumbnails if possible
* Allow cancellation during upload
* Provide detailed error messages for failed uploads
* Show a success animation/notification upon successful upload
* Automatically initiate the first step of receipt processing after successful upload
* Handle network interruptions gracefully with retry options

## Success Criteria
* Users can successfully upload single and multiple files
* The interface remains responsive during file uploads
* Progress is clearly communicated
* Errors are handled gracefully with helpful messages
* Success is confirmed with appropriate feedback
* Files are correctly stored in Supabase storage
* Receipt records are properly created in the database
* The user experience is intuitive and frustration-free

## Resources
* Supabase Storage documentation for file upload implementation
* Drag and drop API reference
* Modern file upload UX patterns for inspiration

## Implementation Notes
* Consider implementing chunked uploads for large files
* Use a library like React Dropzone for drag-and-drop functionality
* Implement client-side validation for file types and sizes before uploading
* Optimize image previews to avoid performance issues with large images
* Consider adding file compression for images before upload
* Remember to clean up any temporary resources (like object URLs) to prevent memory leaks
* Implement proper error handling at each step of the upload process 